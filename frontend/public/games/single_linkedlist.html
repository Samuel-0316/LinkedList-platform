<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Train Master - Learn Linked Lists</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: #cef4d656;
            color: white;
            min-height: 100vh;
        }

        .game-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .sky {
            height: 200px;
            background: linear-gradient(#001f3f, #003366);
            position: relative;
            overflow: hidden;
        }

        .stars {
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: radial-gradient(white 1px, transparent 1px);
            background-size: 50px 50px;
            animation: starTwinkle 3s infinite;
        }

        @keyframes starTwinkle {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        .train-track {
            background: #2c3e50;
            padding: 40px 20px;
            position: relative;
            min-height: 250px;
            border-top: 10px solid #34495e;
            border-bottom: 10px solid #34495e;
            overflow-x: auto;
        }

        .rails {
            position: absolute;
            bottom: 30px;
            left: 0;
            right: 0;
            height: 8px;
            background: #95a5a6;
        }

        .train {
            display: flex;
            align-items: center;
            position: relative;
            z-index: 1;
            transition: transform 0.5s;
        }

        .engine {
            width: 150px;
            height: 100px;
            background: #3ca0e7;
            border-radius: 10px;
            position: relative;
            margin-right: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .engine:before {
            content: 'Head';
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            color: #fff;
            font-weight: bold;
        }

        .compartment {
            width: 120px;
            height: 80px;
            background: #3498db;
            border-radius: 8px;
            margin: 0 5px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transition: all 0.3s;
            cursor: pointer;
            flex-direction: column;
        }

        .compartment:after {
            content: '→';
            position: absolute;
            right: -15px;
            font-size: 20px;
            color: #f1c40f;
        }

        .compartment:last-child:after {
            content: '⊥';
            color: #e74c3c;
        }

        .compartment .index {
            font-size: 0.8em;
            color: #f1c40f;
            margin-top: 5px;
        }

        .controls {
            background: rgba(44, 62, 80, 0.9);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .control-panel {
            background: #34495e;
            padding: 15px;
            border-radius: 8px;
        }

        .panel-title {
            color: #f1c40f;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        input {
            width: 100%;
            padding: 8px;
            margin: 5px 0;
            border: none;
            border-radius: 4px;
            background: #2c3e50;
            color: white;
        }

        button {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            border: none;
            border-radius: 4px;
            background: #733ca6;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        button:hover {
            background: #c0392b;
        }

        .mission-panel {
            background: #2980b9;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .mission-title {
            color: #f1c40f;
            font-size: 1.5em;
            margin-bottom: 10px;
        }

        .message {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #e74c3c;
            padding: 10px 20px;
            border-radius: 8px;
            z-index: 1000;
            display: none;
        }

        .traversal-display {
            background: rgba(44, 62, 80, 0.9);
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            font-family: monospace;
            white-space: pre;
        }

        .highlight {
            background: #f1c40f;
            transform: translateY(-5px);
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="sky">
            <div class="stars"></div>
        </div>

        <div class="mission-panel">
            <div class="mission-title">Linked List Training</div>
            <div id="currentMission">Welcome to Train Master! Learn linked lists by managing your train.</div>
        </div>

        <div class="controls">
            <div class="control-panel">
                <div class="panel-title">Add Compartment</div>
                <input type="text" id="insertValue" placeholder="Compartment Value">
                <input type="number" id="insertPosition" placeholder="Position (0 = start)">
                <button onclick="insertCompartment()">Insert at Position</button>
                <button onclick="appendCompartment()">Append to End</button>
            </div>

            <div class="control-panel">
                <div class="panel-title">Remove Compartment</div>
                <input type="number" id="deletePosition" placeholder="Position to Remove">
                <button onclick="deleteCompartment()">Remove Compartment</button>
            </div>

            <div class="control-panel">
                <div class="panel-title">Traverse List</div>
                <button onclick="traverseList()">Show Traversal</button>
            </div>
        </div>

        <div class="train-track">
            <div class="rails"></div>
            <div class="train" id="train">
                <div class="engine"></div>
            </div>
        </div>

        <div class="traversal-display" id="traversalDisplay"></div>
        <div class="message" id="message"></div>
    </div>

    <script>
        class Node {
            constructor(value) {
                this.value = value;
                this.next = null;
            }
        }

        class LinkedList {
            constructor() {
                this.head = null;
                this.size = 0;
            }

            insert(value, position) {
                if (position < 0 || position > this.size) {
                    throw new Error("Invalid position");
                }

                const newNode = new Node(value);

                if (position === 0) {
                    newNode.next = this.head;
                    this.head = newNode;
                } else {
                    let current = this.head;
                    for (let i = 0; i < position - 1; i++) {
                        current = current.next;
                    }
                    newNode.next = current.next;
                    current.next = newNode;
                }
                this.size++;
            }

            append(value) {
                this.insert(value, this.size);
            }

            remove(position) {
                if (position < 0 || position >= this.size) {
                    throw new Error("Invalid position");
                }

                let removedValue;
                if (position === 0) {
                    removedValue = this.head.value;
                    this.head = this.head.next;
                } else {
                    let current = this.head;
                    for (let i = 0; i < position - 1; i++) {
                        current = current.next;
                    }
                    removedValue = current.next.value;
                    current.next = current.next.next;
                }
                this.size--;
                return removedValue;
            }

            traverse() {
                let result = [];
                let current = this.head;
                while (current !== null) {
                    result.push(current.value);
                    current = current.next;
                }
                return result;
            }

            getSize() {
                return this.size;
            }
        }

        const train = new LinkedList();
    

        let currentMissionIndex = 0;

        function showMessage(text, duration = 2000) {
            const message = document.getElementById('message');
            message.textContent = text;
            message.style.display = 'block';
            setTimeout(() => {
                message.style.display = 'none';
            }, duration);
        }

        function renderTrain() {
            const trainElement = document.getElementById('train');
            const engine = trainElement.querySelector('.engine');
            trainElement.innerHTML = '';
            trainElement.appendChild(engine);

            let current = train.head;
            let index = 0;
            while (current !== null) {
                const compartment = document.createElement('div');
                compartment.className = 'compartment';
                compartment.innerHTML = `
                    <div>${current.value}</div>
                    <div class="index">pos: ${index}</div>
                `;
                trainElement.appendChild(compartment);
                current = current.next;
                index++;
            }
        }

        function insertCompartment() {
            const value = document.getElementById('insertValue').value;
            const position = parseInt(document.getElementById('insertPosition').value);

            if (!value) {
                showMessage("Please enter a compartment value!");
                return;
            }

            try {
                train.insert(value, position);
                renderTrain();
                showMessage("Compartment inserted successfully!");
                checkMission();
            } catch (error) {
                showMessage(error.message);
            }
        }

        function appendCompartment() {
            const value = document.getElementById('insertValue').value;

            if (!value) {
                showMessage("Please enter a compartment value!");
                return;
            }

            train.append(value);
            renderTrain();
            showMessage("Compartment appended successfully!");
            checkMission();
        }

        function deleteCompartment() {
            const position = parseInt(document.getElementById('deletePosition').value);

            try {
                train.remove(position);
                renderTrain();
                showMessage("Compartment removed successfully!");
                checkMission();
            } catch (error) {
                showMessage(error.message);
            }
        }

        async function traverseList() {
            const compartments = document.querySelectorAll('.compartment');
            const traversalDisplay = document.getElementById('traversalDisplay');
            let output = "Traversing linked list:\n";
            
            for (let i = 0; i < compartments.length; i++) {
                compartments[i].classList.add('highlight');
                output += `Node ${i}: ${train.traverse()[i]}\n`;
                traversalDisplay.textContent = output;
                await new Promise(resolve => setTimeout(resolve, 1000));
                compartments[i].classList.remove('highlight');
            }
            output += "End of list reached!";
            traversalDisplay.textContent = output;
            checkMission();
        }

        

        // Initialize game
        document.getElementById('currentMission').textContent = missions[0].description;
        renderTrain();

        // Add rails
        for (let i = 0; i < 30; i++) {
            const sleeper = document.createElement('div');
            sleeper.className = 'sleeper';
            sleeper.style.left = `${i * 50}px`;
            document.querySelector('.train-track').appendChild(sleeper);
        }
    </script>
</body>
</html>